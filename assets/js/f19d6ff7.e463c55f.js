"use strict";(self.webpackChunkcot_docs=self.webpackChunkcot_docs||[]).push([[862],{1662:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>p,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"local-server-setup/api docker","title":"API (Docker)","description":"Overview","source":"@site/docs/local-server-setup/3_api docker.md","sourceDirName":"local-server-setup","slug":"/local-server-setup/api docker","permalink":"/cot-documentation/docs/local-server-setup/api docker","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/local-server-setup/3_api docker.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"API","permalink":"/cot-documentation/docs/local-server-setup/api"},"next":{"title":"Client","permalink":"/cot-documentation/docs/local-server-setup/client"}}');var s=i(4848),o=i(8453);const c={},a="API (Docker)",r={},l=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Initial Setup: Copy Configuration Files",id:"initial-setup-copy-configuration-files",level:2},{value:"Running Docker",id:"running-docker",level:2},{value:"Step 1: Build the Docker Containers",id:"step-1-build-the-docker-containers",level:3},{value:"Step 2: Start the Docker Containers",id:"step-2-start-the-docker-containers",level:3},{value:"Step 3: Check Application Logs",id:"step-3-check-application-logs",level:3},{value:"Step 4: Stopping the Containers",id:"step-4-stopping-the-containers",level:3},{value:"Accessing the Application and Database via Docker",id:"accessing-the-application-and-database-via-docker",level:2},{value:"Step 1: Access the Application Container",id:"step-1-access-the-application-container",level:3},{value:"Step 2: Access the Database Container",id:"step-2-access-the-database-container",level:3},{value:"Conclusion",id:"conclusion",level:2},{value:"Key Takeaways:",id:"key-takeaways",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"api-docker",children:"API (Docker)"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"This guide provides instructions on setting up and running the NestJS application in a Dockerized environment. The application uses MySQL as a database and includes a few essential setup steps that must be completed before starting the containers."}),"\n",(0,s.jsx)(n.p,{children:"By following these instructions, you will be able to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Set up the environment for running the application in Docker containers."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Ensure proper configuration for database connection and app settings."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Use Docker Compose to manage the application, including the app container and database container."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Before you proceed, ensure that the following software is installed on your machine:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Docker"}),": The application uses Docker for containerization. ",(0,s.jsx)(n.a,{href:"https://docs.docker.com/get-docker/",children:"Install Docker"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Docker Compose"}),": To manage multi-container setups. ",(0,s.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"Install Docker Compose"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Node.js"}),": Ensure that Node.js is available for building the application. ",(0,s.jsx)(n.a,{href:"https://nodejs.org/",children:"Install Node.js"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"initial-setup-copy-configuration-files",children:"Initial Setup: Copy Configuration Files"}),"\n",(0,s.jsx)(n.p,{children:"Before running the Docker containers, you need to copy some configuration files to set up the application. Follow these steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Copy appConfig.example.ts to appConfig.ts","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cp src/appConfig.example.ts src/appConfig.ts\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Copy database.config.example.ts to database.config.ts","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cp src/db/database.config.example.ts src/db/database.config.ts\n"})}),"\n","After copying these files, you can proceed with starting the application using Docker."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"running-docker",children:"Running Docker"}),"\n",(0,s.jsxs)(n.p,{children:["To run the application using Docker, ensure that you're in the ",(0,s.jsx)(n.strong,{children:"API directory"})," where the ",(0,s.jsx)(n.code,{children:"docker-compose.yml"})," file is located."]}),"\n",(0,s.jsx)(n.h3,{id:"step-1-build-the-docker-containers",children:"Step 1: Build the Docker Containers"}),"\n",(0,s.jsx)(n.p,{children:"Run the following command to build the Docker containers:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker compose build\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-start-the-docker-containers",children:"Step 2: Start the Docker Containers"}),"\n",(0,s.jsx)(n.p,{children:"Once the build is complete, run the following command to start the containers:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker compose up\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"When run for the first time, this command will execute database migrations and run the CLI to populate the database."})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["You can verify that the API is running by visiting ",(0,s.jsx)(n.a,{href:"http://localhost:3000/api",children:"http://localhost:3000/api"})]})}),"\n",(0,s.jsx)(n.p,{children:"To check the status of the containers, you can use:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker compose ps\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-check-application-logs",children:"Step 3: Check Application Logs"}),"\n",(0,s.jsx)(n.p,{children:"If you want to see the logs of the running application, you can use:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker compose logs -f\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-4-stopping-the-containers",children:"Step 4: Stopping the Containers"}),"\n",(0,s.jsx)(n.p,{children:"To stop the containers, run the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker compose down\n"})}),"\n",(0,s.jsx)(n.p,{children:"This will stop and remove the containers. If you want to remove the containers along with the volumes (to clear any persistent data), you can use:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker compose down --volumes\n"})}),"\n",(0,s.jsx)(n.h2,{id:"accessing-the-application-and-database-via-docker",children:"Accessing the Application and Database via Docker"}),"\n",(0,s.jsx)(n.p,{children:"Once the containers are running, you can access both the application and the MySQL database through Docker commands."}),"\n",(0,s.jsx)(n.h3,{id:"step-1-access-the-application-container",children:"Step 1: Access the Application Container"}),"\n",(0,s.jsx)(n.p,{children:"To access the running application container, use the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker exec -it nestjs-dev sh\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"This is where you can run CLI commands, create or run migrations, and install new packages. (It's recommended to run npm install here instead of rebuilding the container, as rebuilding can be time-consuming.)"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-access-the-database-container",children:"Step 2: Access the Database Container"}),"\n",(0,s.jsx)(n.p,{children:"To access the MySQL database container, use the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker exec -it mysql8-dev sh\n"})}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"In this guide, we've outlined the steps required to set up, run, and interact with the Dockerized NestJS application and MySQL database. With Docker Compose, we can easily manage the multi-container setup, ensuring a smooth development environment."}),"\n",(0,s.jsx)(n.h3,{id:"key-takeaways",children:"Key Takeaways:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Docker Setup:"})," We've used Docker and Docker Compose to containerize the application, making it portable and easy to run across different environments."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Accessing Containers:"})," With ",(0,s.jsx)(n.code,{children:"docker exec"}),", you can easily access the application container to run commands or check logs, and also access the database container for running SQL queries."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Efficient Development:"})," By using Docker Compose commands like ",(0,s.jsx)(n.code,{children:"docker compose build"})," and ",(0,s.jsx)(n.code,{children:"docker compose up"}),", you can quickly spin up the development environment, allowing you to focus on development without worrying about environment setup."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>a});var t=i(6540);const s={},o=t.createContext(s);function c(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);